<div class="account-header" responsive>
    <div class="account-monkey-title">
        <div
            pxb-icon
            style="height: 150px; width: 150px"
            *ngIf="monkeySvg && !vp.sm"
            [innerHTML]="monkeySvg | safe"
        ></div>
        <div>
            <div [class.mat-display-2]="!vp.sm" [class.mat-display-1]="vp.sm" [style.marginBottom.px]="8">
                <span *ngIf="loading">Loading</span>
                <ng-container *ngIf="accountOverview?.delegatorsCount === 0">
                    <span *ngIf="accountOverview?.opened"> Account Information </span>
                    <span *ngIf="!accountOverview?.opened"> Unopened Account </span>
                </ng-container>
                <span *ngIf="accountOverview?.delegatorsCount > 0">Representative Account</span>
            </div>
            <div class="mat-subheading-2" style="word-break: break-all; margin-right: 24px">
                {{ address }}
            </div>
            <div class="account-summary-tags" *ngIf="accountOverview">
                <pxb-list-item-tag label="Representative Online"></pxb-list-item-tag>
                <!--<pxb-list-item-tag
                    [label]="convertRawToBan(accountOverview.balanceRaw) + ' BALANCE'"
                    class="account-balance"
                >
                </pxb-list-item-tag>
                <pxb-list-item-tag
                    [label]="convertRawToBan(accountOverview.pendingRaw) + ' PENDING'"
                    class="account-pending"
                ></pxb-list-item-tag> -->
            </div>
        </div>
    </div>
    <div style="display: flex; align-items: center">
        <div
            pxb-icon
            style="height: 150px; width: 150px"
            *ngIf="monkeySvg && vp.sm"
            [innerHTML]="monkeySvg | safe"
        ></div>
        <canvas id="qr-code" [style.display]="loading ? 'none' : 'block' "></canvas>
    </div>
</div>

<ng-template #pageinator>
    <mat-paginator
            *ngIf="accountOverview.completedTxCount > 50"
            [length]="accountOverview.completedTxCount"
            [pageSize]="paginatorSize"
            [pageIndex]="currentPage"
            [disabled]="loading"
            (page)="changePage($event)"
    >
    </mat-paginator>
</ng-template>

<mat-tab-group *ngIf="!loading" class="account-tabs">
    <mat-tab class="account-confirmed-tab">
        <ng-template mat-tab-label>
            <span color="accent" matBadgeOverlap="false" [matBadge]="formatBadge(accountOverview.completedTxCount)">
                Completed <ng-container *ngIf="!vp.sm">Transactions</ng-container>
            </span>
        </ng-template>
        <div class="account-history">
            <pxb-empty-state
                *ngIf="confirmedTransactions.display.length === 0"
                class="account-empty-state"
                title="No Confirmed Transactions"
                description="This account has not received or sent anything yet."
            >
                <mat-icon pxb-empty-icon>paid</mat-icon>
            </pxb-empty-state>
            <ng-template [ngTemplateOutlet]="pageinator"></ng-template>
            <mat-divider></mat-divider>
            <mat-list *ngIf="confirmedTransactions.display.length >= 0" [style.paddingTop.px]="0">
                <pxb-info-list-item
                    *ngFor="let tx of confirmedTransactions.display; trackBy: trackByFn"
                    [divider]="true"
                    [wrapTitle]="true"
                    [wrapSubtitle]="false"
                    [hidePadding]="true"
                    style="background-color: white; position: relative"
                >
                    <div pxb-icon *ngIf="!vp.sm">
                        <div *ngIf="monkeySvg" [innerHTML]="monkeySvg | safe"></div>
                    </div>
                    <div pxb-title>
                        <div>
                            <pxb-list-item-tag [label]="tx.formatHeight" [class]="'height ' + tx.type"></pxb-list-item-tag>
                            <pxb-list-item-tag [label]="tx.type" [class]="'type ' + tx.type"></pxb-list-item-tag>
                            <span *ngIf="tx.type !== 'change'" [class]="'amount ' + tx.type">{{ tx.balance }}</span>
                        </div>
                        <div>
                            <span class="to-from">{{ tx.type === 'receive' ? ' from' : 'to' }}</span>
                            <span class="address" (click)="search.emit(tx.address)">
                                {{ ' ' + tx.address }}
                            </span>
                        </div>
                    </div>
                    <div pxb-subtitle class="hash">{{ tx.hash }}</div>
                    <div pxb-right-content>
                        <div class="timestamps" responsive>
                            <span>{{ tx.date }}</span>
                            <span>{{ tx.time }}</span>
                        </div>
                    </div>
                </pxb-info-list-item>
                <ng-template [ngTemplateOutlet]="pageinator"></ng-template>
            </mat-list>
        </div>
    </mat-tab>

    <mat-tab class="account-pending-tab">
        <ng-template mat-tab-label>
            <span color="primary" [matBadge]="accountOverview.pendingTxCount" matBadgeOverlap="false">
                Pending <ng-container *ngIf="!vp.sm">Transactions</ng-container>
            </span>
        </ng-template>
        <div class="account-history">
            <pxb-empty-state
                class="account-empty-state"
                *ngIf="pendingTransactions.length === 0"
                title="No Pending Transactions"
                description="This account has already received all pending payments"
            >
                <mat-icon pxb-empty-icon>paid</mat-icon>
            </pxb-empty-state>
            <mat-list [style.paddingTop.px]="0">
                <pxb-info-list-item
                    *ngFor="let tx of pendingTransactions; trackBy: trackByFn"
                    [divider]="true"
                    [wrapTitle]="true"
                    [wrapSubtitle]="false"
                    style="background-color: white; position: relative"
                >
                    <div pxb-icon>
                        <div *ngIf="monkeySvg" [innerHTML]="monkeySvg | safe"></div>
                    </div>
                    <div pxb-title>
                        <div>
                            <pxb-list-item-tag [label]="'receive'" class="type receive"></pxb-list-item-tag>
                            <span class="amount receive">{{ convertRawToBan(tx.balanceRaw, 'receive') }}</span>
                        </div>
                        <div>
                            <span class="to-from">from</span>
                            <span class="address" (click)="search.emit(tx.address)">
                                {{ ' ' + tx.address }}
                            </span>
                        </div>
                    </div>
                    <div pxb-subtitle class="hash">{{ tx.hash }}</div>
                </pxb-info-list-item>
            </mat-list>
        </div>
    </mat-tab>

    <mat-tab class="account-delegators-tab">
        <ng-template mat-tab-label>
            <span color="primary" [matBadge]="accountOverview.delegatorsCount" matBadgeOverlap="false">
                Delegators
            </span>
        </ng-template>
        <div class="account-delegators">

            <table [style.width.%]="100" *ngIf="delegators.length > 0" mat-table [dataSource]="delegators" class="mat-elevation-z4">
                <ng-container matColumnDef="address">
                    <th mat-header-cell *matHeaderCellDef> Address </th>
                    <td mat-cell class="account-delegator-address-cell" *matCellDef="let element" (click)="search.emit(element.address)"> {{element.address}} </td>
                </ng-container>
                <ng-container matColumnDef="weight">
                    <th mat-header-cell [style.paddingLeft.px]="16"  *matHeaderCellDef> Weight (BAN) </th>
                    <td mat-cell  [style.paddingLeft.px]="16"  *matCellDef="let element"> {{element.weight}} </td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="['address', 'weight']"></tr>
                <tr mat-row *matRowDef="let row; columns: ['address', 'weight'];"></tr>
            </table>
            <div *ngIf="delegators.length > 0" style="text-align: right; margin-top: 8px; font-size: 10px">
                *Accounts with a 0 BANANO balance have been removed from the total delegators count.
            </div>

            <pxb-empty-state
                *ngIf="delegators.length === 0"
                class="account-empty-state"
                title="No Delegators"
                description="This account has no delegated weight.  If this account is not running a node, this is a good thing."
            >
                <mat-icon pxb-empty-icon>how_to_vote</mat-icon>
            </pxb-empty-state>
        </div>
    </mat-tab>
</mat-tab-group>
