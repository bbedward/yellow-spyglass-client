<ng-template #titleContent>
    <div class="app-page-title">
        <ng-container *ngIf="!loading">Representatives</ng-container>
        <ng-container *ngIf="loading">Loading</ng-container>
    </div>
    <div class="app-page-subtitle">
        Representatives process transactions on the BANANO network. See all representatives below.
    </div>
</ng-template>

<ng-template #bodyContent>
    <div class="app-section-title">Weight Distribution</div>
    <div class="app-section-subtitle">Online voting weight allocation between the largest representatives.</div>
    <mat-slide-toggle color="primary" class="app-section-subtitle" [(ngModel)]="showOfflineWeight">
        Include offline representatives
    </mat-slide-toggle>
    <app-weight-chart
        [onlineWeight]="onlineWeight"
        [offlineWeight]="offlineWeight"
        [largeReps]="allLargeReps"
        [showOfflineWeight]="showOfflineWeight"
    ></app-weight-chart>

    <div style="display: flex">
        <div style="width: 100%; margin-right: 16px">
            <div class="app-section-title">
                Monitored Representatives <span class="app-caption">({{ monitoredReps.length }})</span>
            </div>
            <div class="app-section-subtitle">
                Online representatives that use the
                <a class="link primary" href="https://github.com/NanoTools/nanoNodeMonitor" target="_blank">
                    Nano Node Monitor
                </a>
                software are shown in the list below.
            </div>
        </div>
        <pxb-user-menu
            *ngIf="!vp.sm"
            class="app-user-menu"
            style="align-items: end; margin-bottom: 4px"
            [(open)]="monitoredRepColumnToggle"
        >
            <mat-icon pxb-avatar>more_vert</mat-icon>
            <mat-nav-list pxb-menu-body [style.paddingTop.px]="0">
                <pxb-info-list-item
                    [dense]="true"
                    [hidePadding]="true"
                    (click)="shownColumns.showAddress = !shownColumns.showAddress"
                >
                    <mat-checkbox
                        color="primary"
                        pxb-left-content
                        [checked]="shownColumns.showAddress"
                        style="pointer-events: none"
                    ></mat-checkbox>
                    <div pxb-title>Address</div>
                </pxb-info-list-item>

                <pxb-info-list-item
                    [dense]="true"
                    [hidePadding]="true"
                    (click)="shownColumns.showVersion = !shownColumns.showVersion"
                >
                    <mat-checkbox
                        color="primary"
                        pxb-left-content
                        [checked]="shownColumns.showVersion"
                        style="pointer-events: none"
                    ></mat-checkbox>
                    <div pxb-title>Version</div>
                </pxb-info-list-item>

                <pxb-info-list-item
                    [dense]="true"
                    [hidePadding]="true"
                    (click)="shownColumns.showDelegatorsCount = !shownColumns.showDelegatorsCount"
                >
                    <mat-checkbox
                        color="primary"
                        pxb-left-content
                        [checked]="shownColumns.showDelegatorsCount"
                        style="pointer-events: none"
                    ></mat-checkbox>
                    <div pxb-title>Delegators</div>
                </pxb-info-list-item>

                <pxb-info-list-item
                    [dense]="true"
                    [hidePadding]="true"
                    (click)="shownColumns.showWeight = !shownColumns.showWeight"
                >
                    <mat-checkbox
                        color="primary"
                        pxb-left-content
                        [checked]="shownColumns.showWeight"
                        style="pointer-events: none"
                    ></mat-checkbox>
                    <div pxb-title>Weight</div>
                </pxb-info-list-item>

                <pxb-info-list-item
                    [dense]="true"
                    [hidePadding]="true"
                    (click)="shownColumns.showPeerCount = !shownColumns.showPeerCount"
                >
                    <mat-checkbox
                        color="primary"
                        pxb-left-content
                        [checked]="shownColumns.showPeerCount"
                        style="pointer-events: none"
                    ></mat-checkbox>
                    <div pxb-title>Peer Count</div>
                </pxb-info-list-item>

                <pxb-info-list-item
                    [dense]="true"
                    [hidePadding]="true"
                    (click)="shownColumns.showUncheckedBlocks = !shownColumns.showUncheckedBlocks"
                >
                    <mat-checkbox
                        color="primary"
                        pxb-left-content
                        [checked]="shownColumns.showUncheckedBlocks"
                        style="pointer-events: none"
                    ></mat-checkbox>
                    <div pxb-title>Unchecked Blocks</div>
                </pxb-info-list-item>

                <pxb-info-list-item
                    [dense]="true"
                    [hidePadding]="true"
                    (click)="shownColumns.showCementedBlocks = !shownColumns.showCementedBlocks"
                >
                    <mat-checkbox
                        color="primary"
                        pxb-left-content
                        [checked]="shownColumns.showCementedBlocks"
                        style="pointer-events: none"
                    ></mat-checkbox>
                    <div pxb-title>Cemented Blocks</div>
                </pxb-info-list-item>

                <pxb-info-list-item
                    [dense]="true"
                    [hidePadding]="true"
                    (click)="shownColumns.showLocation = !shownColumns.showLocation"
                >
                    <mat-checkbox
                        color="primary"
                        pxb-left-content
                        [checked]="shownColumns.showLocation"
                        style="pointer-events: none"
                    ></mat-checkbox>
                    <div pxb-title>Location</div>
                </pxb-info-list-item>

                <pxb-info-list-item
                    [dense]="true"
                    [hidePadding]="true"
                    (click)="shownColumns.showMemory = !shownColumns.showMemory"
                >
                    <mat-checkbox
                        color="primary"
                        pxb-left-content
                        [checked]="shownColumns.showMemory"
                        style="pointer-events: none"
                    ></mat-checkbox>
                    <div pxb-title>Memory Usage</div>
                </pxb-info-list-item>

                <pxb-info-list-item
                    [dense]="true"
                    [hidePadding]="true"
                    (click)="shownColumns.showUptime = !shownColumns.showUptime"
                >
                    <mat-checkbox
                        color="primary"
                        pxb-left-content
                        [checked]="shownColumns.showUptime"
                        style="pointer-events: none"
                    ></mat-checkbox>
                    <div pxb-title>Uptime</div>
                </pxb-info-list-item>
            </mat-nav-list>
        </pxb-user-menu>
    </div>
    <app-monitored-rep-table
        *ngIf="!vp.sm"
        [monitoredReps]="monitoredReps"
        [onlineWeight]="onlineWeight"
        [shownColumns]="shownColumns"
    ></app-monitored-rep-table>
    <app-monitored-rep-list
        *ngIf="vp.sm"
        [monitoredReps]="monitoredReps"
        [onlineWeight]="onlineWeight"
    ></app-monitored-rep-list>
    <div class="app-section-title" [style.marginTop.px]="72">
        Large Representatives
        <span class="app-caption">({{ onlineLargeRepsCount }} of {{ allLargeReps.length }} online)</span>
    </div>
    <div class="app-section-subtitle">
        List of representatives with at least 100,000 BANANO weight delegated towards them.
    </div>
    <mat-slide-toggle
        color="primary"
        class="app-section-subtitle"
        [(ngModel)]="showOfflineRepsFilter"
        (change)="filterLargeRepsByStatus()"
    >
        Show offline representatives
    </mat-slide-toggle>
    <app-large-rep-table
        *ngIf="!vp.sm"
        [onlineWeight]="onlineWeight"
        [shownReps]="shownLargeReps"
    ></app-large-rep-table>
    <app-large-rep-cards *ngIf="vp.sm" [onlineWeight]="onlineWeight" [shownReps]="shownLargeReps"></app-large-rep-cards>

    <ng-container *ngIf="microReps?.length > 0">
        <div class="app-section-title" [style.marginTop.px]="72">
            Micro Representatives
            <span class="app-caption">({{ onlineMicroRepsCount }})</span>
        </div>
        <div class="app-section-subtitle">
            Online representatives with less than 100,000 BANANO weight delegated towards them.
        </div>
        <app-micro-rep-list [onlineWeight]="onlineWeight" [microReps]="microReps"></app-micro-rep-list>
    </ng-container>
</ng-template>

<div class="app-page-root" responsive>
    <div class="app-page-content">
        <app-error *ngIf="error"></app-error>
        <ng-container *ngIf="!error">
            <ng-template [ngTemplateOutlet]="titleContent"></ng-template>
            <ng-template *ngIf="!loading" [ngTemplateOutlet]="bodyContent"></ng-template>
        </ng-container>
    </div>
</div>

<app-wave [darkThemeWaveNumber]="5" [lightThemeWaveNumber]="23"></app-wave>
