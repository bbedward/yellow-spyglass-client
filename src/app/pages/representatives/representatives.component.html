<ng-template #titleContent>
    <div class="app-page-title">
        <ng-container *ngIf="!isLoading">Representatives</ng-container>
        <ng-container *ngIf="isLoading">Loading</ng-container>
    </div>
    <div class="app-page-subtitle">
        Representatives process transactions on the BANANO network. See all representatives below.
    </div>
</ng-template>

<ng-template #bodyContent>
    <div class="app-section-title">Weight Distribution</div>
    <div class="app-section-subtitle">Online voting weight allocation between the largest representatives.</div>
    <mat-slide-toggle color="primary" class="app-section-subtitle" [(ngModel)]="showOfflineWeight">
        Include offline representatives
    </mat-slide-toggle>
    <app-weight-chart
        [onlineWeight]="onlineWeight"
        [offlineWeight]="offlineWeight"
        [largeReps]="allLargeReps"
        [showOfflineWeight]="showOfflineWeight"
    ></app-weight-chart>

    <div style="display: flex">
        <div style="width: 100%; margin-right: 16px">
            <div class="app-section-title">
                Monitored Representatives <span class="app-caption">({{ monitoredReps.length }})</span>
            </div>
            <div class="app-section-subtitle">
                Online representatives that use the
                <a class="link primary" href="https://github.com/NanoTools/nanoNodeMonitor" target="_blank">
                    Nano Node Monitor
                </a>
                software are shown in the list below.
            </div>
        </div>

        <div *ngIf="!vp.sm" style="display: flex; align-items: end; padding-bottom: 24px">
            <button mat-mini-fab
                    color="primary"
                    class="monitored-table-edit-button button-1"
                    [class.expanded]="expandedMonitoredTable"
                    (click)="expandedMonitoredTable = !expandedMonitoredTable">
                <mat-icon>{{expandedMonitoredTable ? 'close_fullscreen' : 'open_in_full'}}</mat-icon>
            </button>


            <button mat-mini-fab
                    color="primary"
                    class="monitored-table-edit-button button-2"
                    [class.expanded]="expandedMonitoredTable"
                    [matMenuTriggerFor]="columns">
                <mat-icon blui-avatar>more_vert</mat-icon>
            </button>
            <mat-menu #columns="matMenu" [hasBackdrop]="true" (click)="$event.stopPropagation()">
                <mat-nav-list blui-menu-body [style.paddingTop.px]="0">
                    <blui-info-list-item [dense]="true" [hidePadding]="true" (click)="toggleColumnT($event, 'address')">
                        <mat-checkbox
                            color="primary"
                            blui-left-content
                            [checked]="shownColumns.address"
                            style="pointer-events: none"
                        ></mat-checkbox>
                        <div blui-title>Address</div>
                    </blui-info-list-item>

                    <blui-info-list-item [dense]="true" [hidePadding]="true" (click)="toggleColumnT($event, 'version')">
                        <mat-checkbox
                            color="primary"
                            blui-left-content
                            [checked]="shownColumns.version"
                            style="pointer-events: none"
                        ></mat-checkbox>
                        <div blui-title>Version</div>
                    </blui-info-list-item>

                    <blui-info-list-item [dense]="true" [hidePadding]="true" (click)="toggleColumnT($event, 'delegatorsCount')">
                        <mat-checkbox
                            color="primary"
                            blui-left-content
                            [checked]="shownColumns.delegatorsCount"
                            style="pointer-events: none"
                        ></mat-checkbox>
                        <div blui-title>Delegators</div>
                    </blui-info-list-item>

                    <blui-info-list-item [dense]="true" [hidePadding]="true" (click)="toggleColumnT($event, 'weightBan')">
                        <mat-checkbox
                            color="primary"
                            blui-left-content
                            [checked]="shownColumns.weightBan"
                            style="pointer-events: none"
                        ></mat-checkbox>
                        <div blui-title>Weight (BAN)</div>
                    </blui-info-list-item>

                    <blui-info-list-item [dense]="true" [hidePadding]="true" (click)="toggleColumnT($event, 'weightPercent')">
                        <mat-checkbox
                            color="primary"
                            blui-left-content
                            [checked]="shownColumns.weightPercent"
                            style="pointer-events: none"
                        ></mat-checkbox>
                        <div blui-title>Weight (%)</div>
                    </blui-info-list-item>

                    <blui-info-list-item [dense]="true" [hidePadding]="true" (click)="toggleColumnT($event, 'peerCount')">
                        <mat-checkbox
                            color="primary"
                            blui-left-content
                            [checked]="shownColumns.peerCount"
                            style="pointer-events: none"
                        ></mat-checkbox>
                        <div blui-title>Peer Count</div>
                    </blui-info-list-item>

                    <blui-info-list-item [dense]="true" [hidePadding]="true" (click)="toggleColumnT($event, 'uncheckedBlocks')">
                        <mat-checkbox
                            color="primary"
                            blui-left-content
                            [checked]="shownColumns.uncheckedBlocks"
                            style="pointer-events: none"
                        ></mat-checkbox>
                        <div blui-title>Unchecked Blocks</div>
                    </blui-info-list-item>

                    <blui-info-list-item [dense]="true" [hidePadding]="true" (click)="toggleColumnT($event, 'cementedBlocks')">
                        <mat-checkbox
                            color="primary"
                            blui-left-content
                            [checked]="shownColumns.cementedBlocks"
                            style="pointer-events: none"
                        ></mat-checkbox>
                        <div blui-title>Cemented Blocks</div>
                    </blui-info-list-item>

                    <blui-info-list-item [dense]="true" [hidePadding]="true" (click)="toggleColumnT($event, 'location')">
                        <mat-checkbox
                            color="primary"
                            blui-left-content
                            [checked]="shownColumns.location"
                            style="pointer-events: none"
                        ></mat-checkbox>
                        <div blui-title>Location</div>
                    </blui-info-list-item>

                    <blui-info-list-item [dense]="true" [hidePadding]="true" (click)="toggleColumnT($event, 'memory')">
                        <mat-checkbox
                            color="primary"
                            blui-left-content
                            [checked]="shownColumns.memory"
                            style="pointer-events: none"
                        ></mat-checkbox>
                        <div blui-title>Memory Usage</div>
                    </blui-info-list-item>

                    <blui-info-list-item [dense]="true" [hidePadding]="true" (click)="toggleColumnT($event, 'lastRestart')">
                        <mat-checkbox
                            color="primary"
                            blui-left-content
                            [checked]="shownColumns.lastRestart"
                            style="pointer-events: none"
                        ></mat-checkbox>
                        <div blui-title>Last Restart</div>
                    </blui-info-list-item>
                    <blui-info-list-item [dense]="true" [hidePadding]="true" (click)="toggleColumnT($event, 'isPrincipal')">
                        <mat-checkbox
                            color="primary"
                            blui-left-content
                            [checked]="shownColumns.isPrincipal"
                            style="pointer-events: none"
                        ></mat-checkbox>
                        <div blui-title>Principal Rep</div>
                    </blui-info-list-item>

                    <blui-info-list-item [dense]="true" [hidePadding]="true" (click)="toggleColumnT($event, 'uptime')">
                        <mat-checkbox
                            color="primary"
                            blui-left-content
                            [checked]="shownColumns.uptime"
                            style="pointer-events: none"
                        ></mat-checkbox>
                        <div blui-title>Uptime</div>
                    </blui-info-list-item>
                </mat-nav-list>
            </mat-menu>
        </div>


    </div>
    <app-monitored-rep-table
        *ngIf="!vp.sm"
        [class.expanded]="expandedMonitoredTable"
        [monitoredReps]="monitoredReps"
        [onlineWeight]="onlineWeight"
        [shownColumns]="shownColumns"
        [largeReps]="allLargeReps"
    ></app-monitored-rep-table>
    <app-monitored-rep-list
        *ngIf="vp.sm"
        [monitoredReps]="monitoredReps"
        [onlineWeight]="onlineWeight"
    ></app-monitored-rep-list>
    <div class="app-section-title" [style.marginTop.px]="72">
        Large Representatives
        <span class="app-caption">({{ onlineLargeRepsCount }} of {{ allLargeReps.length }} online)</span>
    </div>
    <div class="app-section-subtitle">
        List of representatives with at least 100,000 BANANO weight delegated towards them.
    </div>
    <mat-slide-toggle
        color="primary"
        class="app-section-subtitle"
        [(ngModel)]="showOfflineReps"
        (change)="filterLargeRepsByStatus()"
    >
        Show offline representatives
    </mat-slide-toggle>
    <app-large-rep-table
        *ngIf="!vp.sm"
        [onlineWeight]="onlineWeight"
        [shownReps]="shownLargeReps"
    ></app-large-rep-table>
    <app-large-rep-cards *ngIf="vp.sm" [onlineWeight]="onlineWeight" [shownReps]="shownLargeReps"></app-large-rep-cards>
</ng-template>

<div class="app-page-root" responsive>
    <div class="app-page-content">
        <app-error *ngIf="hasError"></app-error>
        <ng-container *ngIf="!hasError">
            <ng-template [ngTemplateOutlet]="titleContent"></ng-template>
            <ng-template *ngIf="!isLoading" [ngTemplateOutlet]="bodyContent"></ng-template>
        </ng-container>
    </div>
</div>

<!--
<app-wave [darkThemeWaveNumber]="5" [lightThemeWaveNumber]="23"></app-wave>
-->
